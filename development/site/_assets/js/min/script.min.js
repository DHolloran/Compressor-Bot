/* Author:
Dan Holloran http://danholloran.com
http://compressorbot.com
Copyright CompressorBot 2012 and beyond
*/$(function(){function I(){$.getJSON(D+"_assets/includes/helpers/uses_left.php",function(a){G.empty();if(a==="Unlimited"){G.hide();H.hide()}else{G.show();H.show();a<10?G.append("Uses left "+a+"/10"):G.append("No uses left")}})}function J(a,b,c){var d,e=a,f=$(".output");if($.parseJSON(b)){d="Success!";f.empty().append(d);c.css({height:a+=20});setTimeout(function(){c.parent().fadeOut(300,function(){c.css({height:e});f.empty()})},2e3)}else{d="Please try again.";f.empty().append(d);c.css({height:a+=20})}}function K(a){var b="https://www.paypal.com/cgi-bin/webscr?cmd="+a[0]+"&hosted_button_id="+a[1]+"&on0=&os0="+a[2]+"&currency_code="+a[3];window.location=b}function L(){$.getJSON("sandbox2.php",function(a){var b=$.parseJSON(a.messages)})}var a=$(".modal_link"),b=$(".modal_close"),c=$(".modal_wrapper"),d=c.find("section"),e=$(document).width(),f=$(".tool_switch"),g=$(".language_choice"),h=$(".html_options"),i=$(".css_options"),j=$(".js_options"),k=$(".tool_btn"),l=$(".languages_options"),m=$("input[type=text]"),n=$("input[type=email]"),o=$("textarea"),p=$("#contact_modal"),q=p.find("select"),r=$("#contact_form"),s=r.find("button"),t=$(".pass1"),u=$(".pass2"),v=$("#edit_modal"),w=$("#login_form"),x=$("#video_player"),y=$("#compress_insert"),z=$("#compress_modal"),A=$("#compress_upload"),B=$("#decompress_insert"),C=$("#decompress_modal"),D,E=$("#register_modal"),F=E.find("form"),G=$(".uses_left"),H=$(".signup_link");document.location.hostname==="localhost"?D="http://localhost/~dholloran/compressorbot/development/site/":D="http://compressorbot.com/development/site";G.length!==0&&I();a.on("click",function(a){var b=$(this),c=$(b.attr("href")),e=c.parent();e.css({height:$(document).outerHeight(),width:$(document).outerWidth()});d.css({top:e.outerHeight()/2-c.outerHeight()/2,left:e.outerWidth()/2-c.outerWidth()/2});e.fadeIn(300);a.preventDefault();return!1});b.on("click",function(a){var b=$(this);c.fadeOut(300);c.find(".success").empty();c.find(".output").empty();G.length!==0&&I();a.preventDefault();return!1});f.on("click",function(a){var b=$(this);$(b.attr("href")).fadeIn(300);$("#"+b.data("tool")).fadeOut(300);a.preventDefault();return!1});(function(){if(l.length!==0){var a=l.find("input[type=radio]:checked"),b=a.data("lang");b==="js"?b="Javascript":b=b.toUpperCase();k.data("page")==="decompress"?k.val("Decompress "+b):k.val("Compress "+b)}})();g.on("click",function(a){var b=$(this),c=b.data("lang");h.hide();i.hide();j.hide();$("."+b.data("lang")+"_options").fadeIn(300);$("."+c).prop("checked",!0);c==="js"?c="Javascript":c=c.toUpperCase();k.data("page")==="decompress"?k.val("Decompress "+c):k.val("Compress "+c)});q.on("change",function(a){var b=$(this),c=p.find("hgroup h3");b.val()==="bug_submit"?c.empty().append("We will get working on this right away"):c.empty().append("Someone will contact you within 24 hours.")});r.on("submit",function(a){var b=$(this),c=b.parent().outerHeight(),d=p.find(".error_field");p.find(".success").empty();d.hide();$.post(D+"/_assets/includes/helpers/sendmail.php",b.serialize(),function(a){J(c,a,p)});a.preventDefault()});u.on("change",function(a){var b=$(this),c=b.siblings(".pass1").val(),d=b.siblings(".error_field").hide();c!==b.val()&&d.empty().append("Passwords do not match").show()});v.find("form").on("submit",function(a){var b=$(this),c=v.outerHeight(),d=$(".paypal1").val(),e=$(".paypal2").val(),f=$(".paypal3").val(),g=$(".paypal4").val(),h=[d,e,f,g];$.post(D+"/_assets/includes/controller/EditProfile.php",b.serialize(),function(a){var d=b.serialize(),e=$.parseJSON(a);e==="basic"?J(c,a,v):(e==="monthly"||e==="yearly")&&K(h);I()});a.preventDefault()});F.on("submit",function(a){var b=$(this),c=$(".paypal1").val(),d=$(".paypal2").val(),e=$(".paypal3").val(),f=$(".paypal4").val(),g=[c,d,e,f];$.post(D+"/_assets/includes/controller/Register.php",b.serialize(),function(a){var c=b,d=$.parseJSON(a);d==="basic"?window.location=D:d==="paypal"&&K(g)});a.preventDefault()});w.on("submit",function(a){var b=$(this),c=w.find(".error_field");c.hide();$.post(D+"/_assets/includes/helpers/login.php",b.serialize(),function(a){if($.parseJSON(a)){c.hide();window.location=$.parseJSON(a)[1]}else c.show()});a.preventDefault()});x.length!==0&&x.H5Video({events:{pause:function(){},play:function(){},end:function(){}},animationDuration:350,source:{"video/ogg":D+"/_assets/media/video/compressorbot_placeholder_video.theora.ogv","video/mp4":D+"/_assets/media/video/compressorbot_placeholder_video.mp4","video/webm":D+"/_assets/media/video/compressorbot_placeholder_video.webm"},loop:!1,preload:!0,autoPlay:!1,poster:D+"/_assets/img/home/poster.png",supportMessage:"This browser cannot playback HTML5 videos. We encourage you to upgrade your internet browser to one of the following modern browsers:"});y.on("submit",function(a){var b=$(this),c=z.parent();b.find(".css_validate:checked").length===0&&b.find(".html_validate:checked").length===0;b.find(".css_lint:checked").length===0;b.find(".js_lint:checked").length===0;$.post("../_assets/includes/helpers/compress.php",b.serialize(),function(a){var b=$.parseJSON(a);if(b!=="access denied"){c.css({height:$(document).outerHeight(),width:$(document).outerWidth()});d.css({top:c.outerHeight()/2-z.outerHeight()/2,left:c.outerWidth()/2-z.outerWidth()/2});z.find("textarea").val(b);z.parent().fadeIn(300)}else G.empty().append("No uses left!")});a.preventDefault()});B.on("submit",function(a){var b=$(this),c=C.parent();$.post("../_assets/includes/helpers/decompress.php",b.serialize(),function(a){console.log(a)});a.preventDefault()});A.on("change",function(a){var b=$(this),c=$("#table_wrapper").find("table tbody");c.empty();$.each(a.target.files,function(a,b){var d=0;if(b.fileSize<1024)d+="b";else if(b.fileSize>=1024&&b.fileSize<=1048576){d=b.fileSize/1024;d=Math.round(d*100)/100;d+="kb"}else if(b.fileSize>=1048576&&b.fileSize<=10485760){d=b.fileSize/1048576;d=Math.round(d*100)/100;d+="mb"}var e=b.type;switch(e){case"application/x-javascript":e="js";break;case"text/css":e="css";break;case"text/html":e="html";break;default:e="?"}c.append("<tr><td>"+b.fileName+"</td><td>"+d+"</td><td>"+e+"</td></tr>")})})});